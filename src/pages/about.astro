---
import { FaJs, FaNodeJs, FaPython, FaReact } from 'react-icons/fa';
import { SiKubernetes, SiTypescript } from 'react-icons/si';
import { SITE_URL } from '../consts';
import BaseLayout from '../layouts/BaseLayout.astro';

const skills = [
  {
    name: 'Kubernetes',
    level: 85,
    icon: SiKubernetes,
  },
  {
    name: 'TypeScript',
    level: 85,
    icon: SiTypescript,
  },
  {
    name: 'Angular',
    level: 65,
    icon: FaReact,
  },
  {
    name: 'Node.js',
    level: 82,
    icon: FaNodeJs,
  },
];
---
<BaseLayout
  title="About Me"
  description="Learn more about my background, skills, and experience"
  type="website"
  url={`${SITE_URL}/about`}
>
  <div class="max-w-6xl mx-auto px-4 sm:px-6 py-8 sm:py-12 md:py-16 theme-transition-all">
    <!-- Hero Section - Improved mobile layout -->
    <div class="relative mb-12 sm:mb-16 md:mb-20">
      <!-- Decorative elements - adjusted for better mobile appearance -->
      <div class="absolute -top-10 sm:-top-20 -left-10 sm:-left-20 w-36 sm:w-48 md:w-72 h-36 sm:h-48 md:h-72 bg-zinc-100 dark:bg-zinc-800/30 rounded-full blur-3xl opacity-30 animate-blob theme-transition-bg"></div>
      <div class="absolute -bottom-10 sm:-bottom-20 -right-10 sm:-right-20 w-36 sm:w-48 md:w-72 h-36 sm:h-48 md:h-72 bg-zinc-200 dark:bg-zinc-800/30 rounded-full blur-3xl opacity-30 animate-blob animation-delay-2000 theme-transition-bg"></div>

      <div class="relative grid grid-cols-1 md:grid-cols-2 gap-8 md:gap-12 items-center">
        <div class="order-2 md:order-1 text-center md:text-left">
          <h1 class="text-3xl sm:text-4xl md:text-5xl font-bold tracking-tight text-zinc-900 dark:text-zinc-100 mb-4 sm:mb-6 theme-transition-color">
            Hello, I'm <span class="text-transparent bg-clip-text bg-gradient-to-r from-zinc-500 to-zinc-900 dark:from-zinc-300 dark:to-zinc-100 theme-transition-all">Andrea Romanello</span>
          </h1>

          <p class="text-lg sm:text-xl text-zinc-600 dark:text-zinc-400 mb-6 sm:mb-8 leading-relaxed theme-transition-color">
            Searching, improving, building â€” every single day.
          </p>

          <div class="flex flex-wrap gap-4 social-links-container justify-center md:justify-start theme-transition-children">
            <!-- Social links remain the same -->
          </div>
        </div>

        <div class="order-1 md:order-2 relative">
          <div class="aspect-square w-full max-w-[280px] sm:max-w-[320px] md:max-w-md mx-auto overflow-hidden rounded-3xl border-4 sm:border-8 border-white dark:border-zinc-800 shadow-xl sm:shadow-2xl theme-transition-all">
            <img
              src="/me.jpg"
              alt="Profile photo"
              class="w-full h-full object-cover"
              loading="eager"
            />
          </div>

          <!-- Decorative elements - adjusted for mobile -->
          <div class="absolute -bottom-4 sm:-bottom-6 -right-4 sm:-right-6 w-16 sm:w-20 md:w-24 h-16 sm:h-20 md:h-24 bg-zinc-100 dark:bg-zinc-800 rounded-full border-2 sm:border-4 border-white dark:border-zinc-900 shadow-lg flex items-center justify-center theme-transition-all">
            <span class="text-2xl sm:text-3xl">ðŸ‘‹</span>
          </div>
        </div>
      </div>
    </div>

    <!-- About Section - Improved spacing for mobile -->
    <div class="mb-16 sm:mb-20 md:mb-24 theme-transition-all">
      <div class="max-w-3xl mx-auto">
        <h2 class="text-2xl sm:text-3xl font-bold text-zinc-900 dark:text-zinc-100 mb-6 sm:mb-8 flex items-center justify-center md:justify-start theme-transition-color">
          <span class="hidden sm:inline-block w-8 sm:w-12 h-1 bg-zinc-300 dark:bg-zinc-700 mr-4 theme-transition-bg"></span>
          About Me
          <span class="hidden sm:inline-block w-8 sm:w-12 h-1 bg-zinc-300 dark:bg-zinc-700 ml-4 theme-transition-bg"></span>
        </h2>

        <div class="prose prose-zinc dark:prose-invert max-w-none theme-transition-all">
          <p class="text-base sm:text-lg leading-relaxed mb-4 sm:mb-6 theme-transition-color">
            I'm a software engineer and an R&D Manager at <a href="https://www.trigenia.it" target="_blank" class="text-zinc-900 dark:text-zinc-100 hover:text-zinc-700 dark:hover:text-zinc-300 transition-all duration-300 theme-transition-color">Trigenia</a>,
            where I lead the development of new products and features.
            I define the architecture of our systems and oversee the infrastructure that supports them.
            Over the years I've worked across multiple industries, delivering projects ranging from small personal tools to large enterprise platforms.
          </p>
        </div>

        <h3 class="text-xl sm:text-2xl font-bold text-zinc-900 dark:text-zinc-100 mb-6 sm:mb-8 mt-12 flex items-center justify-center md:justify-start theme-transition-color">
          <span class="hidden sm:inline-block w-8 sm:w-12 h-1 bg-zinc-300 dark:bg-zinc-700 mr-4 theme-transition-bg"></span>
          My mission
          <span class="hidden sm:inline-block w-8 sm:w-12 h-1 bg-zinc-300 dark:bg-zinc-700 ml-4 theme-transition-bg"></span>
        </h3>

        <div class="prose prose-zinc dark:prose-invert max-w-none theme-transition-all">
          <p class="text-base sm:text-lg leading-relaxed mb-4 sm:mb-6 theme-transition-color">
            I believe that reliable software and clean infrastructure are the foundation of sustainable digital products.
            On this blog I share what I learn about building real-world production systems: AI, architecture patterns, IaC,
            container and Kubernetes, full-stack integration, monitoring and observability.
            <br><br>
            If you also care about code quality, maintainability, and deployment automation â€” this site is for you.
          </p>
        </div>

        <h3 class="text-xl sm:text-2xl font-bold text-zinc-900 dark:text-zinc-100 mb-6 sm:mb-8 flex items-center justify-center md:justify-start theme-transition-color mt-12">
          <span class="hidden sm:inline-block w-8 sm:w-12 h-1 bg-zinc-300 dark:bg-zinc-700 mr-4 theme-transition-bg"></span>
          What I know (tech & workflow)
          <span class="hidden sm:inline-block w-8 sm:w-12 h-1 bg-zinc-300 dark:bg-zinc-700 ml-4 theme-transition-bg"></span>
        </h3>

        <div class="prose prose-zinc dark:prose-invert max-w-none theme-transition-all">
          <p class="text-base sm:text-lg leading-relaxed mb-4 sm:mb-6 theme-transition-color">
            <ul class="list-disc list-inside">
              <li>TypeScript and Node.js</li>
              <li>Fastify â€” building APIs and services</li>
              <li>Database â€” PostgreSQL, MongoDB, Redis, TimescaleDB, Elasticsearch</li>
              <li>Angular â€” for frontend when needed</li>
              <li>Docker / containerization â€” building and running applications in containers</li>
              <li>Kubernetes â€” manage the infrastructure and deploy the applications</li>
              <li>Terraform / IaC â€” infrastructure as code for reproducible environments</li>
              <li>DevOps & Cloud workflows â€” CI/CD, pipelines, deployment automation</li>
              <li>Cloud providers â€” Azure and AWS</li>
            </ul>
          </p>

          <!-- Other paragraphs remain the same -->
        </div>
      </div>
    </div>

    <!-- Skills Section - Improved for mobile
    <div class="mb-16 sm:mb-20 md:mb-24 theme-transition-all">
      <h2 class="text-2xl sm:text-3xl font-bold text-zinc-900 dark:text-zinc-100 mb-8 sm:mb-12 text-center theme-transition-color">Tech Stack</h2>

      <div class="tech-stack-slider relative overflow-hidden py-4 sm:py-8">
        <div class="slider-track flex animate-slide">
          {[...skills, ...skills, ...skills].map((skill, index) => (
            <div key={`${skill.name}-${index}`} class="skill-card min-w-[220px] sm:min-w-[280px] mx-2 sm:mx-4 bg-white dark:bg-zinc-800/50 rounded-xl border border-zinc-200 dark:border-zinc-700 hover:border-zinc-300 dark:hover:border-zinc-600 transition-all duration-300 hover:shadow-xl transform hover:-translate-y-2 hover:scale-105 theme-transition-element">
              <div class="p-4 sm:p-6">
                <div class="flex items-center justify-between mb-4 sm:mb-6">
                  <div class="flex items-center gap-2 sm:gap-4">
                    <div class="w-8 h-8 sm:w-12 sm:h-12 flex items-center justify-center bg-zinc-100 dark:bg-zinc-800 rounded-lg text-zinc-800 dark:text-zinc-200 transform transition-transform group-hover:rotate-12 theme-transition-bg theme-transition-color">
                      <skill.icon size={20} className="sm:text-2xl transform transition-all hover:scale-125" />
                    </div>
                    <h3 class="text-base sm:text-xl font-semibold text-zinc-900 dark:text-zinc-100 theme-transition-color">{skill.name}</h3>
                  </div>
                  <span class="text-xs sm:text-sm font-mono bg-zinc-100 dark:bg-zinc-800 text-zinc-600 dark:text-zinc-400 px-2 py-0.5 sm:px-2.5 sm:py-1 rounded-full theme-transition-all">{skill.level}%</span>
                </div>

                <div class="relative h-1.5 sm:h-2 w-full bg-zinc-100 dark:bg-zinc-700 overflow-hidden rounded-full theme-transition-bg">
                  <div
                    class="absolute top-0 left-0 h-full bg-gradient-to-r from-zinc-700 via-zinc-600 to-zinc-800 dark:from-zinc-300 dark:via-zinc-400 dark:to-zinc-200 rounded-full transition-all duration-1000 progress-bar-animate theme-transition-bg"
                    style={`width: ${skill.level}%`}
                  ></div>
                </div>

                <div class="flex justify-between mt-1 sm:mt-2 text-[10px] sm:text-xs text-zinc-400 dark:text-zinc-500 font-mono theme-transition-color">
                  <span>Beginner</span>
                  <span>Advanced</span>
                </div>
              </div>
            </div>
          ))}
        </div>

        <!-- Gradient overlays for smooth fade effect
        <div class="absolute top-0 bottom-0 left-0 w-12 sm:w-24 bg-gradient-to-r from-white dark:from-zinc-900 to-transparent z-10 theme-transition-bg"></div>
        <div class="absolute top-0 bottom-0 right-0 w-12 sm:w-24 bg-gradient-to-l from-white dark:from-zinc-900 to-transparent z-10 theme-transition-bg"></div>
      </div>
    </div>
    -->

    <!-- Contact Section - Improved for mobile -->
    <div class="max-w-3xl mx-auto text-center theme-transition-all">
      <h2 class="text-2xl sm:text-3xl font-bold text-zinc-900 dark:text-zinc-100 mb-4 sm:mb-6 theme-transition-color">Get in Touch</h2>
      <p class="text-base sm:text-lg text-zinc-600 dark:text-zinc-400 mb-6 sm:mb-8 theme-transition-color">
        I'm always open to new opportunities and collaborations. If you'd like to work together or just say hello,
        feel free to reach out.
      </p>

      <div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
        <a
          href="https://github.com/rommelandrea"
          target="_blank"
          rel="noopener noreferrer"
          class="inline-flex items-center justify-center px-6 sm:px-8 py-3 sm:py-4 rounded-lg bg-zinc-900 dark:bg-zinc-100 text-zinc-100 dark:text-zinc-900 hover:bg-zinc-700 dark:hover:bg-zinc-300 transition-colors text-base sm:text-lg font-medium theme-transition-all"
        >
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 sm:h-5 sm:w-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
            <path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd"></path>
          </svg>
          GitHub
        </a>
        <a
          href="https://linkedin.com/in/andrea-romanello"
          target="_blank"
          rel="noopener noreferrer"
          class="inline-flex items-center justify-center px-6 sm:px-8 py-3 sm:py-4 rounded-lg bg-zinc-900 dark:bg-zinc-100 text-zinc-100 dark:text-zinc-900 hover:bg-zinc-700 dark:hover:bg-zinc-300 transition-colors text-base sm:text-lg font-medium theme-transition-all"
        >
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 sm:h-5 sm:w-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
            <path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"></path>
          </svg>
          LinkedIn
        </a>
      </div>
    </div>
  </div>
</BaseLayout>

<style>
  /* Blob animation */
  .animate-blob {
    animation: blob-bounce 8s infinite ease;
  }

  .animation-delay-2000 {
    animation-delay: 2s;
  }

  @keyframes blob-bounce {
    0%, 100% {
      transform: translate(0, 0) scale(1);
    }
    25% {
      transform: translate(5%, 5%) scale(1.05);
    }
    50% {
      transform: translate(0, 10%) scale(1);
    }
    75% {
      transform: translate(-5%, 5%) scale(0.95);
    }
  }

  /* Tech Stack Slider - Seamless infinite loop */
  .slider-track {
    width: fit-content;
    animation: scroll 40s linear infinite;
  }

  @keyframes scroll {
    0% {
      transform: translateX(0);
    }
    100% {
      transform: translateX(calc(-220px * 6 - 16px * 6)); /* Card width + margin for mobile */
    }
  }

  @media (min-width: 640px) {
    .slider-track {
      animation: scroll 60s linear infinite;
    }

    @keyframes scroll {
      0% {
        transform: translateX(0);
      }
      100% {
        transform: translateX(calc(-280px * 6 - 32px * 6)); /* Card width + margin for desktop */
      }
    }
  }

  .tech-stack-slider:hover .slider-track {
    animation-play-state: paused;
  }

  .skill-card {
    transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    position: relative;
    overflow: hidden;
  }

  .skill-card:hover {
    z-index: 10;
  }

  /* Reduce animation complexity on mobile for better performance */
  @media (max-width: 640px) {
    .skill-card {
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .skill-card:hover {
      transform: translateY(-5px) !important;
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1) !important;
    }
  }

  .skill-card:before {
    content: '';
    position: absolute;
    top: -10%;
    left: -10%;
    width: 120%;
    height: 120%;
    background: radial-gradient(circle at center, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
    opacity: 0;
    transition: opacity 0.5s ease;
    pointer-events: none;
  }

  .skill-card:hover:before {
    opacity: 1;
  }

  .progress-bar-animate {
    position: relative;
    overflow: hidden;
  }

  .progress-bar-animate:after {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
    animation: progress-shine 2s infinite;
  }

  @keyframes progress-shine {
    0% {
      left: -100%;
    }
    100% {
      left: 100%;
    }
  }

  /* Improved touch targets for mobile */
  @media (max-width: 640px) {
    a, button {
      min-height: 44px;
      display: flex;
      align-items: center;
    }

    .social-link {
      min-width: 44px;
      min-height: 44px;
    }
  }

  /* Theme transition effect */
  :global(.theme-switching) .theme-transition-element {
    animation: fadeIn 0.6s cubic-bezier(0.22, 1, 0.36, 1);
  }

  /* Smooth card transition during theme switch */
  .skill-card.theme-transition-element {
    transition: background-color var(--theme-transition),
                border-color var(--theme-transition),
                color var(--theme-transition),
                box-shadow var(--theme-transition),
                transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  }
</style>

<script>
  // Wait for the DOM to be fully loaded
  document.addEventListener('DOMContentLoaded', () => {
    const sliderTrack = document.querySelector('.slider-track');

    // Create seamless infinite scrolling effect
    function setupInfiniteScroll() {
      const cards = document.querySelectorAll('.skill-card');
      if (!cards.length) return;

      // Clone the first set of cards and append to create seamless loop
      const firstSetCount = cards.length / 3; // We have 3 sets in the markup

      // Set proper animation based on screen size
      function updateScrollAnimation() {
        if (window.innerWidth >= 640) {
          sliderTrack.style.animation = 'scroll 60s linear infinite';
        } else {
          sliderTrack.style.animation = 'scroll 40s linear infinite';
        }
      }

      updateScrollAnimation();
      window.addEventListener('resize', updateScrollAnimation);
    }

    setupInfiniteScroll();

    // Pause animation on hover/touch
    sliderTrack?.addEventListener('mouseenter', () => {
      sliderTrack.style.animationPlayState = 'paused';
    });

    sliderTrack?.addEventListener('touchstart', () => {
      sliderTrack.style.animationPlayState = 'paused';
    });

    sliderTrack?.addEventListener('mouseleave', () => {
      sliderTrack.style.animationPlayState = 'running';
    });

    sliderTrack?.addEventListener('touchend', () => {
      setTimeout(() => {
        sliderTrack.style.animationPlayState = 'running';
      }, 1000); // Delay resuming animation after touch
    });

    // Add hover effects to cards - only on non-touch devices
    const isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
    const cards = document.querySelectorAll('.skill-card');

    if (!isTouchDevice) {
      cards.forEach(card => {
        card.addEventListener('mousemove', (e) => {
          const rect = card.getBoundingClientRect();
          const x = e.clientX - rect.left;
          const y = e.clientY - rect.top;

          const centerX = rect.width / 2;
          const centerY = rect.height / 2;

          const angleX = (y - centerY) / 15;
          const angleY = (centerX - x) / 15;

          card.style.transform = `perspective(1000px) rotateX(${angleX}deg) rotateY(${angleY}deg) scale(1.08) translateZ(20px)`;

          // Dynamic shadow based on tilt
          const shadowX = (x - centerX) / 25;
          const shadowY = (y - centerY) / 25;
          card.style.boxShadow = `
            ${shadowX}px ${shadowY}px 20px rgba(0, 0, 0, 0.1),
            0 10px 20px rgba(0, 0, 0, 0.05)
          `;
        });

        card.addEventListener('mouseleave', () => {
          card.style.transform = '';
          card.style.boxShadow = '';
        });
      });
    } else {
      // Simpler effects for touch devices
      cards.forEach(card => {
        card.addEventListener('touchstart', () => {
          card.classList.add('is-touched');
        });

        card.addEventListener('touchend', () => {
          setTimeout(() => {
            card.classList.remove('is-touched');
          }, 300);
        });
      });
    }

    // Handle theme transition
    document.addEventListener('themeChange', () => {
      // Add special effects during theme transition
      cards.forEach((card, index) => {
        // Add staggered animation delay
        setTimeout(() => {
          card.classList.add('theme-changing');
          setTimeout(() => {
            card.classList.remove('theme-changing');
          }, 600);
        }, index * 50);
      });
    });
  });
</script>

<script>
  // Initialize animations for about page
  function animateAboutContent() {
    // Animate hero section elements
    const heroElements = document.querySelectorAll('h1, .order-2 p, .social-links-container');
    heroElements.forEach((el, index) => {
      setTimeout(() => {
        el.classList.add('animate-reveal');
      }, 100 + (index * 150));
    });

    // Animate profile image
    const profileImage = document.querySelector('.aspect-square');
    if (profileImage) {
      setTimeout(() => {
        profileImage.classList.add('animate-reveal');
      }, 200);
    }

    // Animate skill bars with staggered delay
    const skillBars = document.querySelectorAll('.skill-bar');
    skillBars.forEach((bar, index) => {
      setTimeout(() => {
        bar.classList.add('animate-skill');
      }, 500 + (index * 100));
    });

    // Animate sections with staggered delay
    const sections = document.querySelectorAll('section');
    sections.forEach((section, index) => {
      setTimeout(() => {
        section.classList.add('animate-reveal');
      }, 300 + (index * 200));
    });
  }

  // Initialize animations on page load
  document.addEventListener('DOMContentLoaded', animateAboutContent);

  // Re-initialize when content changes via SPA transitions
  document.addEventListener('spa-content-loaded', animateAboutContent);
</script>
